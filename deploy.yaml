name: bookingpro-app
region: nyc

services:
- name: api
  dockerfile_path: src/backend/BookingPro.API/Dockerfile.prod
  source_dir: /
  http_port: 8080
  instance_count: 1
  instance_size_slug: basic-xxs
  routes:
  - path: /api
    preserve_path_prefix: true
  health_check:
    http_path: /ping
    timeout_seconds: 10
    interval_seconds: 30
  envs:
  - key: ASPNETCORE_ENVIRONMENT
    value: "Production"
  - key: ASPNETCORE_URLS
    value: "http://+:8080"
  - key: DATABASE_URL
    value: "${db.DATABASE_URL}"
  - key: ConnectionStrings__DefaultConnection
    value: "${db.DATABASE_URL}"
  - key: Jwt__Key
    value: "${JWT_KEY}"
    type: SECRET
  - key: FrontendUrl
    value: "${APP_URL}"
  - key: EnableSwaggerInProduction
    value: "true"
  - key: SEED_DATA
    value: "true"
  - key: BackendUrl
    value: "${APP_URL}"

- name: frontend
  dockerfile_path: src/frontend/Dockerfile.prod
  source_dir: src/frontend
  http_port: 80
  instance_count: 1
  instance_size_slug: basic-xxs
  routes:
  - path: /
  health_check:
    http_path: /health
    timeout_seconds: 10
    interval_seconds: 30
  envs:
  - key: REACT_APP_API_URL
    value: "/api"
  - key: REACT_APP_APP_NAME
    value: "BookingPro"

databases:
- name: db
  engine: PG
  version: "16"
  size: db-s-dev-database
  num_nodes: 1